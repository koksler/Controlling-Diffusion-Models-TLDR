# Файн-тюнинг

Сэмплеры, CFG и кол-во шагов это базовые методы контроля генерации. Чтобы пойти дальше, и управлять стилем модели напрямую, используя свои веса.

В сети существуют куча fine-tuned моделей, которые меняют именно врожденный стиль: не добавляя, как LoRA, а именно меняя.

Для SDXL наиболее популярные fine-tuned модели это Juggernaut и Dreamshaper. На примере простецкого промпта `photo of a cat` посмотрим на разницу.

Файл-тюн модели создают, потому что базовые модели, как SDXL создают по усреднённой выборке. Она сырая, не имеет выраженного стиля. 

Обе файнтюнки пользовательские, со своими целями:

**DreamShaper (Lykon)** стремится к художественному, полуреалистичному стилю. CG-шное настроение.

**Juggernaut (KandooAI)** стремится к фотореализму из коробки, как из камеры.

> ### Как происходит fine-tuning
> В основном это делается энтузиастами, на основе уже существующих моделей. Способа есть два:
> - **Дообучение** (буквально fine-tune)
> - **Смешивание** (merge, сплющивание двух моделек)

> ### Дообучение
> У нас есть стандартная, скучная SDXL. Мы вносим в неё **отобранный набор изображений по определённой тематике** (куча картин какого-то художника (фу так делать) или куча кадров из аниме, для аниме).
> 
> Модель обучается конкретно на этих примерах, **достраивая веса**, чтобы воспроизводить новый стиль.
> 
> Делают это чтобы обучить модель тому, что она умеет плохо.

> ### Смешивание
> Теперь надо брать две уже существующие модели и смешивать их веса в какой-нибудь пропорции. Например часть модели, которая обучена на реалистичных людях, и часть модели, обученной на пейзажах.
> 
> Dreamshaper и Juggernaut это результат множества мерджей

Разница между дообученными и базовыми моделями кардинальная.

![Checkpoint_comp](/visual/base_vs_fine-tuned.png)

### SDXL 1.0 (Base)
Эта модель выступает в роли контрольной группы. Она понимает концепции, но лишена ярко выраженного художественного стиля и технической отточенности.

**Что-то хорошее:**
- Модель справляется со всеми тремя разноплановыми задачами (животное, объект, пейзаж) на базовом уровне, что подтверждает качество ее первоначального обучения.
- Результаты, хотя и несовершенны, имеют правильную композицию и цветовое решение. "Смазанный, но живописный" результат в третьей генерации показывает, что у модели есть потенциал для художественных задач.

**Что-то плохое:**
- Изображениям не хватает резкости. Это особенно заметно на шерсти кота и текстурах вокруг ноутбука.
- Модель генерирует слегка неестественные детали (лапа кота, не самая точная геометрия объектов), что говорит о недостаточном "понимании" анатомии и физики объектов.
- В генерации №2 модель не смогла определить главный объект, создав беспорядочную композицию, где ноутбук теряется среди других предметов.

### JuggernautXL

Эта модель демонстрирует приоритет **технического качества и объектной точности** над художественной интерпретацией.

**Что-то хорошее:**
- В генерациях №1 и №2 главный объект (кот, ноутбук) проработан безупречно. Текстуры, материалы, отражения — все на высшем уровне. Это идеальная модель для "продукт-шотов".
- Результаты очень чистые, с минимальным количеством шума и артефактов. Модель генерирует стабильные и предсказуемые "фотографии".

**Что-то плохое:**
- Главный провал — генерация №3. Модель услышала "forest", но полностью проигнорировала "fairy tale". Она создала реалистичную, но лишенную сказочности  фотографию леса. Ее фотореализм стал ее же ограничением.
- **Упрощенный фон:** Модель концентрируется на главном объекте, часто жертвуя фоном, который получается "простоватым" и неинтересным.
### DreamshaperXL

Эта модель, в отличие от JuggernautXL, делает ставку на **атмосферу, стиль и эмоциональное воздействие**, иногда в ущерб технической безупречности.

**Что-то хорошее**
- В генерации №3 модель идеально передала "сказочность" леса. Освещение, палитра, причудливые формы деревьев — все работает на создание нужной атмосферы.
- Даже в сцене с ноутбуком, предполагающей реализм, модель находит способ сделать ее более живой за счет более сложной текстуры стола и фактурного освещения.

**Что-то плохое:**
- Модель добавляет "огромное количество шума и резкости". Это ее фирменный стиль, но он же является и ее проклятием. Лапы кота в генерации №1 — яркий пример того, как стилизация приводит к анатомическим ошибкам и артефактам.
- Результат более "авторский" и менее нейтральный, что может не подходить для задач, требующих строгого фотореализма. В целом, модель для этого и не создавалась.
